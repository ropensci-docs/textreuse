<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="textreuse">
<title>Introduction to the textreuse package â€¢ textreuse</title>
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="/apple-touch-icon.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://docs.ropensci.org/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to the textreuse package">
<meta property="og:description" content="textreuse">
<meta property="og:image" content="https://docs.ropensci.org/textreuse/logo.png">
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Matomo --><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.css">
<script src="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.js" data-cfasync="false"></script><script src="https://ropensci.org/scripts/matomo.js"></script><noscript><p><img src="https://ropensci.matomo.cloud/matomo.php?idsite=1&amp;rec=1" style="border:0;" alt=""></p></noscript>
<!-- End Matomo Code -->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    <a href="https://ropensci.org" class="external-link"><img src="https://ropensci.org/img/icon_short_white.svg" id="hexlogo" alt="rOpenSci"></a>
    <a class="navbar-brand me-2" href="../index.html">textreuse</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.1.5</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"></ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/textreuse-alignment.html">Text Alignment</a>
    <a class="dropdown-item" href="../articles/textreuse-introduction.html">Introduction to the textreuse package</a>
    <a class="dropdown-item" href="../articles/textreuse-minhash.html">Minhash and locality-sensitive hashing</a>
    <a class="dropdown-item" href="../articles/textreuse-pairwise.html">Pairwise comparisons for document similarity</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ropensci/textreuse/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Introduction to the textreuse package</h1>
                        <h4 data-toc-skip class="author">Lincoln Mullen</h4>
            
            <h4 data-toc-skip class="date">2024-03-09</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ropensci/textreuse/blob/HEAD/vignettes/textreuse-introduction.Rmd" class="external-link"><code>vignettes/textreuse-introduction.Rmd</code></a></small>
      <div class="d-none name"><code>textreuse-introduction.Rmd</code></div>
    </div>

    
    
<p>The textreuse package provides classes and functions to detect document similarity and text reuse in text corpora. This introductory vignette provides details on the <code>TextReuseTextDocument</code> and <code>TextReuseCorpus</code> classes, as well as functions for tokenizing, hashing, and measuring similarity. See the pairwise, minhash/LSH, or alignment vignettes for details on solving text similarity problems.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/vignette.html" class="external-link">vignette</a></span><span class="op">(</span><span class="st">"textreuse-pairwise"</span>, package <span class="op">=</span> <span class="st">"textreuse"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/vignette.html" class="external-link">vignette</a></span><span class="op">(</span><span class="st">"textreuse-minhash"</span>, package <span class="op">=</span> <span class="st">"textreuse"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/vignette.html" class="external-link">vignette</a></span><span class="op">(</span><span class="st">"textreuse-alignment"</span>, package <span class="op">=</span> <span class="st">"textreuse"</span><span class="op">)</span></span></code></pre></div>
<p>For these vignette we will use a small corpus of eight documents published by the <a href="https://en.wikipedia.org/wiki/American_Tract_Society" class="external-link">American Tract Society</a> and available from the Internet Archive. The <a href="http://lincolnmullen.com/blog/corpus-of-american-tract-society-publications/" class="external-link">full corpus</a> is also available to be downloaded if you wish to test the package.</p>
<div class="section level2">
<h2 id="textreuse-classes">TextReuse classes<a class="anchor" aria-label="anchor" href="#textreuse-classes"></a>
</h2>
<div class="section level3">
<h3 id="textreusetextdocument">TextReuseTextDocument<a class="anchor" aria-label="anchor" href="#textreusetextdocument"></a>
</h3>
<p>The most basic class provided by this package is the <code>TextReuseTextDocument</code> class. This class contains the text of a document and its metadata. When the document is loaded, the text is also tokenized. (See the section on tokenizers below.) Those tokens are then hashed using a hash function. By default the hashes are retained and the tokens are discarded, since using only hashes results in a significant memory savings.</p>
<p>Here we load a file into a <code>TextReuseTextDocument</code> and tokenize it into shingled n-grams, adding an option to retain the tokens.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/textreuse">textreuse</a></span><span class="op">)</span></span>
<span><span class="va">file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/ats/remember00palm.txt"</span>, </span>
<span>                    package <span class="op">=</span> <span class="st">"textreuse"</span><span class="op">)</span></span>
<span><span class="va">doc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/TextReuseTextDocument.html">TextReuseTextDocument</a></span><span class="op">(</span>file <span class="op">=</span> <span class="va">file</span>, meta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"publisher"</span> <span class="op">=</span> <span class="st">"ATS"</span><span class="op">)</span>,</span>
<span>                             tokenizer <span class="op">=</span> <span class="va">tokenize_ngrams</span>, n <span class="op">=</span> <span class="fl">5</span>,</span>
<span>                             keep_tokens <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">doc</span></span></code></pre></div>
<pre><code><span><span class="co">## TextReuseTextDocument</span></span>
<span><span class="co">## file : /usr/local/lib/R/site-library/textreuse/extdata/ats/remember00palm.txt </span></span>
<span><span class="co">## hash_func : hash_string </span></span>
<span><span class="co">## id : remember00palm </span></span>
<span><span class="co">## publisher : ATS </span></span>
<span><span class="co">## tokenizer : tokenize_ngrams </span></span>
<span><span class="co">## content : Remember </span></span>
<span><span class="co">## By </span></span>
<span><span class="co">## Rat Palmer. </span></span>
<span><span class="co">## Boston: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## THE AMERICAN TRACT SOCI] </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Depositories, 28 Cornhill, Boston ; and 13 Biblb House, </span></span>
<span><span class="co">## Astor Place, New York. </span></span>
<span><span class="co">## Entered, according to Act of Congress, in the year 1865</span></span></code></pre>
<p>We can see details of the document with accessor functions. These are derived from the S3 virtual class <code>TextDocument</code> in the <a href="https://cran.r-project.org/package=NLP" class="external-link">NLP</a> package. Notice that an ID has been assigned to the document based on the filename (without the extension). The name of the tokenizer and hash functions are also saved in the metadata.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/NLP/man/generics.html" class="external-link">meta</a></span><span class="op">(</span><span class="va">doc</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $file</span></span>
<span><span class="co">## [1] "/usr/local/lib/R/site-library/textreuse/extdata/ats/remember00palm.txt"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $hash_func</span></span>
<span><span class="co">## [1] "hash_string"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $id</span></span>
<span><span class="co">## [1] "remember00palm"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $publisher</span></span>
<span><span class="co">## [1] "ATS"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $tokenizer</span></span>
<span><span class="co">## [1] "tokenize_ngrams"</span></span></code></pre>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/NLP/man/generics.html" class="external-link">meta</a></span><span class="op">(</span><span class="va">doc</span>, <span class="st">"id"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "remember00palm"</span></span></code></pre>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/NLP/man/generics.html" class="external-link">meta</a></span><span class="op">(</span><span class="va">doc</span>, <span class="st">"date"</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">1865</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="../reference/TextReuseTextDocument-accessors.html">tokens</a></span><span class="op">(</span><span class="va">doc</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "remember by rat palmer boston"       </span></span>
<span><span class="co">## [2] "by rat palmer boston the"            </span></span>
<span><span class="co">## [3] "rat palmer boston the american"      </span></span>
<span><span class="co">## [4] "palmer boston the american tract"    </span></span>
<span><span class="co">## [5] "boston the american tract soci"      </span></span>
<span><span class="co">## [6] "the american tract soci depositories"</span></span></code></pre>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="../reference/TextReuseTextDocument-accessors.html">hashes</a></span><span class="op">(</span><span class="va">doc</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1]  1603439917 -1208020871  1117958556 -1973578767  1310564160  1350652178</span></span></code></pre>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/wordcount.html">wordcount</a></span><span class="op">(</span><span class="va">doc</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 11399</span></span></code></pre>
<p>The <code><a href="../reference/TextReuseTextDocument-accessors.html">tokens()</a></code> and <code><a href="../reference/TextReuseTextDocument-accessors.html">hashes()</a></code> function return the tokens and hashes associated with the document. The <code><a href="https://rdrr.io/pkg/NLP/man/generics.html" class="external-link">meta()</a></code> function returns a named list of all the metadata fields. If that function is called with a specific ID, as in <code>meta(doc, "myfield")</code>, then the value for only that field is returned. You can also assign to the metadata as a whole or a specific field, as in the example above.</p>
<p>In addition the <code><a href="https://rdrr.io/pkg/NLP/man/generics.html" class="external-link">content()</a></code> function provides the unprocessed text of the document.</p>
<p>The assumption is that is that you want to tokenize and hash the tokens from the start. If, however, you wish to do any of those steps yourself, you can load a document with <code>tokenizer = NULL</code>, then use <code><a href="../reference/tokenize.html">tokenize()</a></code> or <code><a href="../reference/rehash.html">rehash()</a></code> to recompute the tokens and hashes.</p>
<p>Note that a <code>TextReuseTextDocument</code> can actually contain two kinds of hashes. The <code><a href="../reference/TextReuseTextDocument-accessors.html">hashes()</a></code> accessor gives you integer representations of each of the tokens in the document: if there are 100,000 tokens in the document, there will be 100,000 hashes. The <code><a href="../reference/TextReuseTextDocument-accessors.html">minhashes()</a></code> accessor gives you a signature that represents the document as a whole but not the specific tokens within it. See the minhash vignette for details: <code><a href="../articles/textreuse-minhash.html">vignette("textreuse-minhash")</a></code>.</p>
</div>
<div class="section level3">
<h3 id="textreusecorpus">TextReuseCorpus<a class="anchor" aria-label="anchor" href="#textreusecorpus"></a>
</h3>
<p>The class <code>TextReuseCorpus</code> provides a list of <code>TextReuseTextDocuments</code>. It derives from the S3 virtual class <code>Corpus</code> in the <a href="https://cran.r-project.org/package=tm" class="external-link">tm</a> package. It can be created from a directory of files (or by providing a vector of paths to files).</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/ats"</span>, package <span class="op">=</span> <span class="st">"textreuse"</span><span class="op">)</span></span>
<span><span class="va">corpus</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/TextReuseCorpus.html">TextReuseCorpus</a></span><span class="op">(</span>dir <span class="op">=</span> <span class="va">dir</span>, tokenizer <span class="op">=</span> <span class="va">tokenize_ngrams</span>, n <span class="op">=</span> <span class="fl">5</span>,</span>
<span>                          progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">corpus</span></span></code></pre></div>
<pre><code><span><span class="co">## TextReuseCorpus</span></span>
<span><span class="co">## Number of documents: 8 </span></span>
<span><span class="co">## hash_func : hash_string </span></span>
<span><span class="co">## tokenizer : tokenize_ngrams</span></span></code></pre>
<p>The names of the items in a <code>TextReuseCorpus</code> are the IDs of the documents. You can use these IDs to subset the corpus or to retrieve specific documents.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">corpus</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "calltounconv00baxt"        "gospeltruth00whit"        </span></span>
<span><span class="co">## [3] "lifeofrevrichard00baxt"    "memoirjamesbrai00ricegoog"</span></span>
<span><span class="co">## [5] "practicalthought00nev"     "remember00palm"           </span></span>
<span><span class="co">## [7] "remembermeorholy00palm"    "thoughtsonpopery00nevi"</span></span></code></pre>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">corpus</span><span class="op">[[</span><span class="st">"remember00palm"</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## TextReuseTextDocument</span></span>
<span><span class="co">## file : /usr/local/lib/R/site-library/textreuse/extdata/ats/remember00palm.txt </span></span>
<span><span class="co">## hash_func : hash_string </span></span>
<span><span class="co">## id : remember00palm </span></span>
<span><span class="co">## minhash_func : </span></span>
<span><span class="co">## tokenizer : tokenize_ngrams </span></span>
<span><span class="co">## content : Remember </span></span>
<span><span class="co">## By </span></span>
<span><span class="co">## Rat Palmer. </span></span>
<span><span class="co">## Boston: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## THE AMERICAN TRACT SOCI] </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Depositories, 28 Cornhill, Boston ; and 13 Biblb House, </span></span>
<span><span class="co">## Astor Place, New York. </span></span>
<span><span class="co">## Entered, according to Act of Congress, in the year 1865</span></span></code></pre>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">corpus</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"calltounconv00baxt"</span>, <span class="st">"lifeofrevrichard00baxt"</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## TextReuseCorpus</span></span>
<span><span class="co">## Number of documents: 2 </span></span>
<span><span class="co">## hash_func : hash_string </span></span>
<span><span class="co">## tokenizer : tokenize_ngrams</span></span></code></pre>
<p>Accessor functions such as <code><a href="https://rdrr.io/pkg/NLP/man/generics.html" class="external-link">meta()</a></code>, <code><a href="../reference/TextReuseTextDocument-accessors.html">tokens()</a></code>, <code><a href="../reference/TextReuseTextDocument-accessors.html">hashes()</a></code>, and <code><a href="../reference/wordcount.html">wordcount()</a></code> have methods that work on corpora.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/wordcount.html">wordcount</a></span><span class="op">(</span><span class="va">corpus</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##        calltounconv00baxt         gospeltruth00whit    lifeofrevrichard00baxt </span></span>
<span><span class="co">##                    134616                     16593                     44283 </span></span>
<span><span class="co">## memoirjamesbrai00ricegoog     practicalthought00nev            remember00palm </span></span>
<span><span class="co">##                    131939                    124544                     11399 </span></span>
<span><span class="co">##    remembermeorholy00palm    thoughtsonpopery00nevi </span></span>
<span><span class="co">##                     11532                     64758</span></span></code></pre>
<p>Note that when creating a corpus, very short or empty documents will be skipped with a warning. A document must have enough words to create at least two n-grams. For example, if five-grams are desired, then the document must have at least six words.</p>
</div>
</div>
<div class="section level2">
<h2 id="tokenizers">Tokenizers<a class="anchor" aria-label="anchor" href="#tokenizers"></a>
</h2>
<p>One of the steps that is performed when loading a <code>TextReuseTextDocument</code>, either individual or in a corpus, is tokenization. Tokenization breaks up a text into pieces, often overlapping. These pieces are the features which are compared when measuring document similarity.</p>
<p>The textreuse package provides a number of tokenizers.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">text</span> <span class="op">&lt;-</span> <span class="st">"How many roads must a man walk down\nBefore you'll call him a man?"</span></span>
<span></span>
<span><span class="fu"><a href="../reference/tokenizers.html">tokenize_words</a></span><span class="op">(</span><span class="va">text</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1] "how"    "many"   "roads"  "must"   "a"      "man"    "walk"   "down"  </span></span>
<span><span class="co">##  [9] "before" "you'll" "call"   "him"    "a"      "man"</span></span></code></pre>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/tokenizers.html">tokenize_sentences</a></span><span class="op">(</span><span class="va">text</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "how many roads must a man walk down" "before you ll call him a man"</span></span></code></pre>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/tokenizers.html">tokenize_ngrams</a></span><span class="op">(</span><span class="va">text</span>, n <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1] "how many roads"     "many roads must"    "roads must a"      </span></span>
<span><span class="co">##  [4] "must a man"         "a man walk"         "man walk down"     </span></span>
<span><span class="co">##  [7] "walk down before"   "down before you'll" "before you'll call"</span></span>
<span><span class="co">## [10] "you'll call him"    "call him a"         "him a man"</span></span></code></pre>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/tokenizers.html">tokenize_skip_ngrams</a></span><span class="op">(</span><span class="va">text</span>, n <span class="op">=</span> <span class="fl">3</span>, k <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1] "how must walk"      "many a down"        "roads man before"  </span></span>
<span><span class="co">##  [4] "must walk you'll"   "a down call"        "man before him"    </span></span>
<span><span class="co">##  [7] "walk you'll a"      "down call man"      "how roads a"       </span></span>
<span><span class="co">## [10] "many must man"      "roads a walk"       "must man down"     </span></span>
<span><span class="co">## [13] "a walk before"      "man down you'll"    "walk before call"  </span></span>
<span><span class="co">## [16] "down you'll him"    "before call a"      "you'll him man"    </span></span>
<span><span class="co">## [19] "how many roads"     "many roads must"    "roads must a"      </span></span>
<span><span class="co">## [22] "must a man"         "a man walk"         "man walk down"     </span></span>
<span><span class="co">## [25] "walk down before"   "down before you'll" "before you'll call"</span></span>
<span><span class="co">## [28] "you'll call him"    "call him a"         "him a man"</span></span></code></pre>
<p>You can write your own tokenizers or use tokenizers from other packages. They should accept a character vector as their first argument.</p>
<p>As an example, we will write a tokenizer function using the  package which splits a text on new lines, perhaps useful for poetry. Notice that the function takes a single string and returns a character vector with one element for each line. (A more robust tokenizer might strip blank lines and punctuation, include an option for lowercasing the text, and check for the validity of arguments.)</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">poem</span> <span class="op">&lt;-</span> <span class="st">"Roses are red\nViolets are blue\nI like using R\nAnd you should too"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="va">poem</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Roses are red</span></span>
<span><span class="co">## Violets are blue</span></span>
<span><span class="co">## I like using R</span></span>
<span><span class="co">## And you should too</span></span></code></pre>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tokenize_lines</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">string</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_split.html" class="external-link">str_split</a></span><span class="op">(</span><span class="va">string</span>, <span class="st">"\n+"</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">tokenize_lines</span><span class="op">(</span><span class="va">poem</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Roses are red"      "Violets are blue"   "I like using R"    </span></span>
<span><span class="co">## [4] "And you should too"</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="hash-functions">Hash functions<a class="anchor" aria-label="anchor" href="#hash-functions"></a>
</h2>
<p>This package provides one function to hash tokens to integers, <code><a href="../reference/hash_string.html">hash_string()</a></code>.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/hash_string.html">hash_string</a></span><span class="op">(</span><span class="fu"><a href="../reference/tokenizers.html">tokenize_words</a></span><span class="op">(</span><span class="va">text</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1] -1918507530  -727342581 -1125663377   258658140   -11612900  1695112593</span></span>
<span><span class="co">##  [7] -1411833952 -1120374007   888404863  -693828095  -290800936  2118188342</span></span>
<span><span class="co">## [13]   -11612900  1695112593</span></span></code></pre>
<p>You can write your own hash functions, or use those provided by the <a href="https://cran.r-project.org/package=digest" class="external-link">digest</a> package.</p>
</div>
<div class="section level2">
<h2 id="comparison-functions">Comparison functions<a class="anchor" aria-label="anchor" href="#comparison-functions"></a>
</h2>
<p>This package provides a number of comparison functions for measuring similarity. These functions take either a set (in which each token is counted one time) or a bag (in which each token is counted as many times as it appears) and compares it to another set or bag.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tokenizers.html">tokenize_words</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"How does it feel, how does it feel?"</span>,</span>
<span>                          <span class="st">"To be without a home"</span>,</span>
<span>                          <span class="st">"Like a complete unknown, like a rolling stone"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tokenizers.html">tokenize_words</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"How does it feel, how does it feel?"</span>,</span>
<span>                          <span class="st">"To be on your own, with no direction home"</span>,</span>
<span>                          <span class="st">"A complete unknown, like a rolling stone"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/similarity-functions.html">jaccard_similarity</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.65</span></span></code></pre>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/similarity-functions.html">jaccard_dissimilarity</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.35</span></span></code></pre>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/similarity-functions.html">jaccard_bag_similarity</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.4</span></span></code></pre>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/similarity-functions.html">ratio_of_matches</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.75</span></span></code></pre>
<p>See the documentation for <code>?similarity-functions</code> for details on what is measured with these functions.</p>
<p>You can write your own similarity functions, which should accept two sets or bags, <code>a</code> and <code>b</code>, should work on both character and numeric vectors, since they are used with either tokens or hashes of tokens, and should return a single numeric score for the comparison. You will need to implement a method for the <code>TextReuseTextDocument</code> class.</p>
</div>
<div class="section level2">
<h2 id="parallelization">Parallelization<a class="anchor" aria-label="anchor" href="#parallelization"></a>
</h2>
<p>This package will use multiple cores for a few functions is an option is set. This only benefits the corpus loading and tokenizing functions, which are often the slowest parts of an analysis. This is implemented with the <a href="https://cran.r-project.org/view=HighPerformanceComputing" class="external-link">parallel package</a>, and does not work on Windows machines. (Regardless of the options set, this package will never attempt to parallelize computations on Windows.)</p>
<p>To use the parallel option, you must specify the number of CPU cores that you wish to use:</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span><span class="st">"mc.cores"</span> <span class="op">=</span> <span class="fl">4L</span><span class="op">)</span></span></code></pre></div>
<p>If that option is set, this package will use multiple cores when possible.</p>
<p>You can figure out how many cores your computer has with <code><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">parallel::detectCores()</a></code>. See <code><a href="https://rdrr.io/r/parallel" class="external-link">help(package = "parallel")</a></code> for more details.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><!-- begin footer --><div class="footer">
    <div class="container">
        <div class="row start top-4 bottom-8">
            <div class="col-2"> <img id="footerlogo" src="https://ropensci.org/img/icon_short_white.svg">
</div>
            <div class="col-10">
                <div class="row">
                    <div class="col-md-4 col-xs-6">
                        <a href="https://github.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-github"></div></a>
                        <a href="https://github.com/ropenscilabs" target="_blank" class="external-link"><div class="icon fa fa-flask"></div></a>
                        <a href="https://hachyderm.io/@ropensci" target="_blank" class="external-link"><div class="icon fab fa-mastodon"></div></a>
                        <a href="https://vimeo.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-vimeo"></div></a>
                    </div>
                </div>
                <div class="row top-4">
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">About</h5>
                            <li><a href="https://ropensci.org/about" class="external-link">About rOpenSci</a></li>
                            <li><a href="https://ropensci.org/software-review" class="external-link">Software Review</a></li>
                            <li><a href="https://ropensci.org/about#team" class="external-link">Our Team</a></li>
                            <li><a href="https://ropensci.org/careers" class="external-link">Jobs</a></li>
                            <li><a href="https://ropensci.org/donate" class="external-link">Donate</a></li>
                            <li><a href="https://ropensci.org/contact" class="external-link">Contact Us</a></li>
                        </ul>
</div>
                    <div class="col-md-3 col-sm-4">
                        <ul>
<h5 class="bottom-2">Community</h5>
                            <li><a href="https://ropensci.org/community/" class="external-link">Our Community</a></li>
                            <li><a href="https://ropensci.org/commcalls/" class="external-link">Community calls</a></li>
                            <li><a href="https://ropensci.org/events/" class="external-link">Events</a></li>
                            <li><a href="https://discuss.ropensci.org/" class="external-link">Join the Discussion</a></li>
                            <li><a href="https://ropensci.org/code-of-conduct" class="external-link">Code of conduct</a></li>
                        </ul>
</div>
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">Resources</h5>
                            <li><a href="https://ropensci.org/packages/" class="external-link">Packages</a></li>
                            <li><a href="https://ropensci.org/usecases/" class="external-link">Use Cases</a></li>
                            <li><a href="https://ropensci.org/talks-papers/" class="external-link">Talks &amp; Publications</a></li>
                            <li><a href="https://docs.ropensci.org/" class="external-link">Documentation</a></li>
                            <li><a href="https://ropensci.org/news/" class="external-link">Newsletter</a></li>
                            <li><a href="https://ropensci.org/how-to-cite-ropensci/" class="external-link">Cite rOpenSci</a></li>
                        </ul>
</div>
                    <div class="col-md-4 col-xs-12">
                        <h5 class="bottom-2"></h5>

                        <p>rOpenSci is a fiscally sponsored project of <a href="http://numfocus.org" class="external-link">NumFOCUS</a>.</p>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- / end footer -->


    </footer>
</div>

  

  

  </body>
</html>
